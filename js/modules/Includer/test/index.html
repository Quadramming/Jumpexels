<!DOCTYPE HTML>
<html>
	<head>
		<title>Include test</title>
		<meta charset='utf-8'/>
		
		<style type='text/css'>
			.console { color: gray; }
		</style>
		
		<script type='text/javascript' src='../Includer.js'></script>
		<script type='text/javascript'>
			var include = new Includer;
			
			function docWrite(text) {
				var myBody = document.getElementsByTagName('body')[0];
				myBody.innerHTML = myBody.innerHTML + text;
			}

			function fakeConsole() {
				this.log = function(text) {
					docWrite('<i class="console">Console: '+text+'</i><br/>');
				};
			}
	
			var console = new fakeConsole;
	
			function main() {
				include.allowWarnings(true);
				include.js('foo.js', function() {docWrite('First foo.js callback<br/>');} );
				include.js('foo.js', function() {docWrite('Skiped - prev foo.js is loading');} );
				include.onLoad(function() { 
						main1(); 
					});
			}
			
			function main1() {
				include.js('foo.js', function() {docWrite('Skiped - foo.js already loaded');} );
				include.js('foo.js', function() {docWrite('Second foo.js callback (Reloaded)<br/>');}, true);
				
				include.onLoad(function() { 
						main2(); 
					});
			}
			
			function main2() {
				console.log('Try to reload foo.js without callback');
				include.js('foo.js', true);
				include.onLoad(function() { 
						main3(); 
					});
			}
			
			function main3() {
				console.log('Try to load chain script');
				include.js('chain1.js', function() { docWrite('Chain1.js is loaded (callback)</br>'); });
			}
		</script>
	</head>
	<body onload='main()'>
	</body>
</html>
